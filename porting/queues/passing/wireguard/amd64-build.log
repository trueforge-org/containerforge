#0 building with "default" instance using docker driver

#1 [internal] load local bake definitions
#1 reading docker-bake.hcl 835B / 835B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 950B done
#2 DONE 0.0s

#3 [internal] load metadata for ghcr.io/trueforge-org/ubuntu:24.04
#3 DONE 0.1s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [1/5] FROM ghcr.io/trueforge-org/ubuntu:24.04@sha256:5348eb7725294e8090c15b7b495e517f82f4b31497d3bb9de71bbe37476e7454
#5 resolve ghcr.io/trueforge-org/ubuntu:24.04@sha256:5348eb7725294e8090c15b7b495e517f82f4b31497d3bb9de71bbe37476e7454 0.0s done
#5 CACHED

#6 [internal] load build context
#6 transferring context: 16.12kB done
#6 DONE 0.0s

#7 [2/5] RUN   echo "**** install dependencies ****" &&   apt-get update && apt-get install -y --no-install-recommends     bc     iproute2     iptables     iputils-ping     kmod     libcap2-bin     qrencode     net-tools     nftables     wireguard-tools &&   echo "wireguard" >> /etc/modules &&   sed -i 's|\[\[ $proto == -4 \]\] && cmd sysctl -q net\.ipv4\.conf\.all\.src_valid_mark=1|[[ $proto == -4 ]] && [[ $(sysctl -n net.ipv4.conf.all.src_valid_mark) != 1 ]] && cmd sysctl -q net.ipv4.conf.all.src_valid_mark=1|' /usr/bin/wg-quick &&   rm -rf /etc/wireguard &&   ln -s /config/wg_confs /etc/wireguard &&   echo "**** clean up ****" &&   rm -rf     /tmp/*
#7 0.151 **** install dependencies ****
#7 0.366 Get:1 http://archive.ubuntu.com/ubuntu noble InRelease [256 kB]
#7 0.367 Get:2 http://security.ubuntu.com/ubuntu noble-security InRelease [126 kB]
#7 0.851 Get:3 http://security.ubuntu.com/ubuntu noble-security/universe amd64 Packages [1,205 kB]
#7 0.877 Get:4 http://archive.ubuntu.com/ubuntu noble-updates InRelease [126 kB]
#7 1.004 Get:5 http://archive.ubuntu.com/ubuntu noble-backports InRelease [126 kB]
#7 1.132 Get:6 http://archive.ubuntu.com/ubuntu noble/universe amd64 Packages [19.3 MB]
#7 1.289 Get:7 http://security.ubuntu.com/ubuntu noble-security/main amd64 Packages [1,829 kB]
#7 1.503 Get:8 http://security.ubuntu.com/ubuntu noble-security/multiverse amd64 Packages [34.8 kB]
#7 1.598 Get:9 http://security.ubuntu.com/ubuntu noble-security/restricted amd64 Packages [3,122 kB]
#7 1.951 Get:10 http://archive.ubuntu.com/ubuntu noble/multiverse amd64 Packages [331 kB]
#7 2.046 Get:11 http://archive.ubuntu.com/ubuntu noble/main amd64 Packages [1,808 kB]
#7 2.152 Get:12 http://archive.ubuntu.com/ubuntu noble/restricted amd64 Packages [117 kB]
#7 2.246 Get:13 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 Packages [2,218 kB]
#7 2.355 Get:14 http://archive.ubuntu.com/ubuntu noble-updates/multiverse amd64 Packages [38.1 kB]
#7 2.448 Get:15 http://archive.ubuntu.com/ubuntu noble-updates/restricted amd64 Packages [3,330 kB]
#7 2.565 Get:16 http://archive.ubuntu.com/ubuntu noble-updates/universe amd64 Packages [2,014 kB]
#7 2.674 Get:17 http://archive.ubuntu.com/ubuntu noble-backports/main amd64 Packages [49.5 kB]
#7 2.767 Get:18 http://archive.ubuntu.com/ubuntu noble-backports/universe amd64 Packages [34.6 kB]
#7 2.924 Fetched 36.1 MB in 3s (13.2 MB/s)
#7 2.924 Reading package lists...
#7 3.730 Reading package lists...
#7 4.562 Building dependency tree...
#7 4.765 Reading state information...
#7 4.943 libcap2-bin is already the newest version (1:2.66-5ubuntu2.2).
#7 4.943 libcap2-bin set to manually installed.
#7 4.943 The following additional packages will be installed:
#7 4.943   libbpf1 libbsd0 libedit2 libip4tc2 libip6tc2 libjansson4 libmnl0
#7 4.943   libnetfilter-conntrack3 libnfnetlink0 libnftables1 libnftnl11 libqrencode4
#7 4.943   libxtables12
#7 4.944 Suggested packages:
#7 4.944   iproute2-doc firewalld openresolv | resolvconf
#7 4.944 Recommended packages:
#7 4.944   libatm1t64
#7 5.009 The following NEW packages will be installed:
#7 5.009   bc iproute2 iptables iputils-ping kmod libbpf1 libbsd0 libedit2 libip4tc2
#7 5.009   libip6tc2 libjansson4 libmnl0 libnetfilter-conntrack3 libnfnetlink0
#7 5.010   libnftables1 libnftnl11 libqrencode4 libxtables12 net-tools nftables
#7 5.010   qrencode wireguard-tools
#7 5.121 0 upgraded, 22 newly installed, 0 to remove and 5 not upgraded.
#7 5.121 Need to get 3,063 kB of archives.
#7 5.121 After this operation, 10.3 MB of additional disk space will be used.
#7 5.121 Get:1 http://archive.ubuntu.com/ubuntu noble/main amd64 libbpf1 amd64 1:1.3.0-2build2 [166 kB]
#7 5.216 Get:2 http://archive.ubuntu.com/ubuntu noble/main amd64 libmnl0 amd64 1.0.5-2build1 [12.3 kB]
#7 5.309 Get:3 http://archive.ubuntu.com/ubuntu noble/main amd64 libxtables12 amd64 1.8.10-3ubuntu2 [35.7 kB]
#7 5.403 Get:4 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 iproute2 amd64 6.1.0-1ubuntu6.2 [1,120 kB]
#7 5.504 Get:5 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 iputils-ping amd64 3:20240117-1ubuntu0.1 [44.6 kB]
#7 5.597 Get:6 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 kmod amd64 31+20240202-2ubuntu7.1 [101 kB]
#7 5.690 Get:7 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 libbsd0 amd64 0.12.1-1build1.1 [41.2 kB]
#7 5.784 Get:8 http://archive.ubuntu.com/ubuntu noble/main amd64 libip4tc2 amd64 1.8.10-3ubuntu2 [23.3 kB]
#7 5.877 Get:9 http://archive.ubuntu.com/ubuntu noble/main amd64 libip6tc2 amd64 1.8.10-3ubuntu2 [23.7 kB]
#7 5.970 Get:10 http://archive.ubuntu.com/ubuntu noble/main amd64 libnfnetlink0 amd64 1.0.2-2build1 [14.8 kB]
#7 6.063 Get:11 http://archive.ubuntu.com/ubuntu noble/main amd64 libnetfilter-conntrack3 amd64 1.0.9-6build1 [45.2 kB]
#7 6.157 Get:12 http://archive.ubuntu.com/ubuntu noble/main amd64 libnftnl11 amd64 1.2.6-2build1 [66.0 kB]
#7 6.250 Get:13 http://archive.ubuntu.com/ubuntu noble/main amd64 iptables amd64 1.8.10-3ubuntu2 [381 kB]
#7 6.345 Get:14 http://archive.ubuntu.com/ubuntu noble/main amd64 libedit2 amd64 3.1-20230828-1build1 [97.6 kB]
#7 6.438 Get:15 http://archive.ubuntu.com/ubuntu noble/main amd64 libjansson4 amd64 2.14-2build2 [32.8 kB]
#7 6.532 Get:16 http://archive.ubuntu.com/ubuntu noble/main amd64 libnftables1 amd64 1.0.9-1build1 [358 kB]
#7 6.627 Get:17 http://archive.ubuntu.com/ubuntu noble/main amd64 nftables amd64 1.0.9-1build1 [69.8 kB]
#7 6.720 Get:18 http://archive.ubuntu.com/ubuntu noble/main amd64 bc amd64 1.07.1-3ubuntu4 [85.3 kB]
#7 6.813 Get:19 http://archive.ubuntu.com/ubuntu noble/universe amd64 libqrencode4 amd64 4.1.1-1build2 [25.0 kB]
#7 6.906 Get:20 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 net-tools amd64 2.10-0.1ubuntu4.4 [204 kB]
#7 7.000 Get:21 http://archive.ubuntu.com/ubuntu noble/universe amd64 qrencode amd64 4.1.1-1build2 [26.1 kB]
#7 7.093 Get:22 http://archive.ubuntu.com/ubuntu noble/main amd64 wireguard-tools amd64 1.0.20210914-1ubuntu4 [89.1 kB]
#7 7.203 debconf: delaying package configuration, since apt-utils is not installed
#7 7.233 Fetched 3,063 kB in 2s (1,475 kB/s)
#7 7.247 Selecting previously unselected package libbpf1:amd64.
#7 7.247 (Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 16577 files and directories currently installed.)
#7 7.259 Preparing to unpack .../00-libbpf1_1%3a1.3.0-2build2_amd64.deb ...
#7 7.260 Unpacking libbpf1:amd64 (1:1.3.0-2build2) ...
#7 7.278 Selecting previously unselected package libmnl0:amd64.
#7 7.280 Preparing to unpack .../01-libmnl0_1.0.5-2build1_amd64.deb ...
#7 7.281 Unpacking libmnl0:amd64 (1.0.5-2build1) ...
#7 7.295 Selecting previously unselected package libxtables12:amd64.
#7 7.297 Preparing to unpack .../02-libxtables12_1.8.10-3ubuntu2_amd64.deb ...
#7 7.297 Unpacking libxtables12:amd64 (1.8.10-3ubuntu2) ...
#7 7.313 Selecting previously unselected package iproute2.
#7 7.314 Preparing to unpack .../03-iproute2_6.1.0-1ubuntu6.2_amd64.deb ...
#7 7.315 Unpacking iproute2 (6.1.0-1ubuntu6.2) ...
#7 7.357 Selecting previously unselected package iputils-ping.
#7 7.359 Preparing to unpack .../04-iputils-ping_3%3a20240117-1ubuntu0.1_amd64.deb ...
#7 7.360 Unpacking iputils-ping (3:20240117-1ubuntu0.1) ...
#7 7.377 Selecting previously unselected package kmod.
#7 7.379 Preparing to unpack .../05-kmod_31+20240202-2ubuntu7.1_amd64.deb ...
#7 7.381 Unpacking kmod (31+20240202-2ubuntu7.1) ...
#7 7.401 Selecting previously unselected package libbsd0:amd64.
#7 7.403 Preparing to unpack .../06-libbsd0_0.12.1-1build1.1_amd64.deb ...
#7 7.404 Unpacking libbsd0:amd64 (0.12.1-1build1.1) ...
#7 7.418 Selecting previously unselected package libip4tc2:amd64.
#7 7.420 Preparing to unpack .../07-libip4tc2_1.8.10-3ubuntu2_amd64.deb ...
#7 7.421 Unpacking libip4tc2:amd64 (1.8.10-3ubuntu2) ...
#7 7.435 Selecting previously unselected package libip6tc2:amd64.
#7 7.437 Preparing to unpack .../08-libip6tc2_1.8.10-3ubuntu2_amd64.deb ...
#7 7.437 Unpacking libip6tc2:amd64 (1.8.10-3ubuntu2) ...
#7 7.452 Selecting previously unselected package libnfnetlink0:amd64.
#7 7.453 Preparing to unpack .../09-libnfnetlink0_1.0.2-2build1_amd64.deb ...
#7 7.454 Unpacking libnfnetlink0:amd64 (1.0.2-2build1) ...
#7 7.469 Selecting previously unselected package libnetfilter-conntrack3:amd64.
#7 7.470 Preparing to unpack .../10-libnetfilter-conntrack3_1.0.9-6build1_amd64.deb ...
#7 7.471 Unpacking libnetfilter-conntrack3:amd64 (1.0.9-6build1) ...
#7 7.487 Selecting previously unselected package libnftnl11:amd64.
#7 7.488 Preparing to unpack .../11-libnftnl11_1.2.6-2build1_amd64.deb ...
#7 7.489 Unpacking libnftnl11:amd64 (1.2.6-2build1) ...
#7 7.504 Selecting previously unselected package iptables.
#7 7.506 Preparing to unpack .../12-iptables_1.8.10-3ubuntu2_amd64.deb ...
#7 7.507 Unpacking iptables (1.8.10-3ubuntu2) ...
#7 7.557 Selecting previously unselected package libedit2:amd64.
#7 7.559 Preparing to unpack .../13-libedit2_3.1-20230828-1build1_amd64.deb ...
#7 7.560 Unpacking libedit2:amd64 (3.1-20230828-1build1) ...
#7 7.576 Selecting previously unselected package libjansson4:amd64.
#7 7.578 Preparing to unpack .../14-libjansson4_2.14-2build2_amd64.deb ...
#7 7.578 Unpacking libjansson4:amd64 (2.14-2build2) ...
#7 7.594 Selecting previously unselected package libnftables1:amd64.
#7 7.595 Preparing to unpack .../15-libnftables1_1.0.9-1build1_amd64.deb ...
#7 7.596 Unpacking libnftables1:amd64 (1.0.9-1build1) ...
#7 7.615 Selecting previously unselected package nftables.
#7 7.617 Preparing to unpack .../16-nftables_1.0.9-1build1_amd64.deb ...
#7 7.618 Unpacking nftables (1.0.9-1build1) ...
#7 7.636 Selecting previously unselected package bc.
#7 7.637 Preparing to unpack .../17-bc_1.07.1-3ubuntu4_amd64.deb ...
#7 7.638 Unpacking bc (1.07.1-3ubuntu4) ...
#7 7.670 Selecting previously unselected package libqrencode4:amd64.
#7 7.672 Preparing to unpack .../18-libqrencode4_4.1.1-1build2_amd64.deb ...
#7 7.672 Unpacking libqrencode4:amd64 (4.1.1-1build2) ...
#7 7.686 Selecting previously unselected package net-tools.
#7 7.688 Preparing to unpack .../19-net-tools_2.10-0.1ubuntu4.4_amd64.deb ...
#7 7.689 Unpacking net-tools (2.10-0.1ubuntu4.4) ...
#7 7.714 Selecting previously unselected package qrencode.
#7 7.716 Preparing to unpack .../20-qrencode_4.1.1-1build2_amd64.deb ...
#7 7.717 Unpacking qrencode (4.1.1-1build2) ...
#7 7.731 Selecting previously unselected package wireguard-tools.
#7 7.733 Preparing to unpack .../21-wireguard-tools_1.0.20210914-1ubuntu4_amd64.deb ...
#7 7.734 Unpacking wireguard-tools (1.0.20210914-1ubuntu4) ...
#7 7.763 Setting up libip4tc2:amd64 (1.8.10-3ubuntu2) ...
#7 7.765 Setting up net-tools (2.10-0.1ubuntu4.4) ...
#7 7.767 Setting up libqrencode4:amd64 (4.1.1-1build2) ...
#7 7.769 Setting up qrencode (4.1.1-1build2) ...
#7 7.771 Setting up libip6tc2:amd64 (1.8.10-3ubuntu2) ...
#7 7.773 Setting up bc (1.07.1-3ubuntu4) ...
#7 7.776 Setting up kmod (31+20240202-2ubuntu7.1) ...
#7 7.785 sed: can't read /etc/modules: No such file or directory
#7 7.818 Setting up libjansson4:amd64 (2.14-2build2) ...
#7 7.819 Setting up libmnl0:amd64 (1.0.5-2build1) ...
#7 7.821 Setting up wireguard-tools (1.0.20210914-1ubuntu4) ...
#7 7.825 Setting up libxtables12:amd64 (1.8.10-3ubuntu2) ...
#7 7.827 Setting up libnfnetlink0:amd64 (1.0.2-2build1) ...
#7 7.829 Setting up libbsd0:amd64 (0.12.1-1build1.1) ...
#7 7.831 Setting up iputils-ping (3:20240117-1ubuntu0.1) ...
#7 7.841 Setting up libbpf1:amd64 (1:1.3.0-2build2) ...
#7 7.843 Setting up iproute2 (6.1.0-1ubuntu6.2) ...
#7 7.925 Setting up libedit2:amd64 (3.1-20230828-1build1) ...
#7 7.927 Setting up libnftnl11:amd64 (1.2.6-2build1) ...
#7 7.929 Setting up libnetfilter-conntrack3:amd64 (1.0.9-6build1) ...
#7 7.931 Setting up libnftables1:amd64 (1.0.9-1build1) ...
#7 7.933 Setting up nftables (1.0.9-1build1) ...
#7 8.008 Setting up iptables (1.8.10-3ubuntu2) ...
#7 8.012 update-alternatives: using /usr/sbin/iptables-legacy to provide /usr/sbin/iptables (iptables) in auto mode
#7 8.015 update-alternatives: using /usr/sbin/ip6tables-legacy to provide /usr/sbin/ip6tables (ip6tables) in auto mode
#7 8.017 update-alternatives: using /usr/sbin/iptables-nft to provide /usr/sbin/iptables (iptables) in auto mode
#7 8.019 update-alternatives: using /usr/sbin/ip6tables-nft to provide /usr/sbin/ip6tables (ip6tables) in auto mode
#7 8.021 update-alternatives: using /usr/sbin/arptables-nft to provide /usr/sbin/arptables (arptables) in auto mode
#7 8.023 update-alternatives: using /usr/sbin/ebtables-nft to provide /usr/sbin/ebtables (ebtables) in auto mode
#7 8.025 Processing triggers for libc-bin (2.39-0ubuntu8.7) ...
#7 8.064 **** clean up ****
#7 DONE 8.2s

#8 [3/5] COPY . /
#8 DONE 0.0s

#9 [4/5] COPY ./root /
#9 DONE 0.0s

#10 [5/5] WORKDIR /config
#10 DONE 0.0s

#11 exporting to image
#11 exporting layers
#11 exporting layers 2.4s done
#11 exporting manifest sha256:c56116c62a8c7b8a7be6eaeecaae52dd5c9802b16a8890f2fa06c828225ea478 done
#11 exporting config sha256:b39de8253fb657f8db3b26e63fca650c10c6ea6e2b3eeb795cfb5b71775b29f2 done
#11 exporting attestation manifest sha256:ad24af77818ee2c59a163369cc7fdb3213c80276e20ea511eb5af2afba70744f done
#11 exporting manifest list sha256:4697d477ca5b665644fae1f6c8bee4b3a454b93b1b51a9888c3cee999a0718ee done
#11 naming to docker.io/library/wireguard:1.0.20250521-r0 done
#11 unpacking to docker.io/library/wireguard:1.0.20250521-r0
#11 unpacking to docker.io/library/wireguard:1.0.20250521-r0 0.5s done
#11 DONE 3.0s
